---
title: "Yield per Recruit"
author: "Joe Thorley"
date: "`r Sys.Date()`"
bibliography: bibliography.bib
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Yield per Recruit}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## Introduction

> Fish are born, they grow, they reproduce and they die – whether from natural causes or from fishing. 
That’s it. 
Modelers just use complicated (or not so complicated) math to iron out the details.

@cooper_guide_2006

Equilibrium based yield per recruit methods estimate the capture rate that optimizes the yield under the assumptions that there is no stochasticity and all density-dependence is captured by the stock-recruitment relationship. The remaining population processes of growth, reproduction and death are captured through a series of relatively straight-forward deterministic equations.

## Growth

### Length

In `ypr` length (in cm) at age ($t$) is assumed to follow a Von Bertalanffy growth curve

$$L = L_{\infty} \cdot (1 - \exp(-k \cdot (t-t_0)))$$

```{r, fig.width=4}
library(ypr)
population <- ypr_population(Linf = 100, k = 0.2, t0 = 0)
ypr_plot_schedule(population, "Age", "Length")
```

### Weight

The weight in ($W$) at a given length is assumed to follow the classic allometric relationship

$$W = w_\alpha \cdot L^{w_\beta}$$

```{r, fig.width=4}
population <- ypr_population_update(population, Wa = 0.01, Wb = 3)
ypr_plot_schedule(population, "Length", "Weight")
```

Its worth noting that $w_\alpha$, which is the extrapolated weight (g) of a 1 cm individual, is a scaling constant that only affects the estimate of the yield (when calculated in terms of the biomass), ie, it does not affect the estimate of the optimal capture rate.

## Reproduction

### Fecundity

The fecundity ($F$) is assumed to scale allometrically with the weight according to the equation

$$F = f_\alpha \cdot W^{f_\beta}$$

```{r, fig.width=4}
population <- ypr_population_update(population, fa = 1, fb = 1)
ypr_plot_schedule(population, "Weight", "Fecundity")
```

$f_\alpha$, which is the extrapolated eggs produced by a 1 g female, is a scaling constant with no effect on the yield or optimal capture rate.

### Spawning

The probability of spawning at length $L$ is determined by the equation

$$S = \frac{L^{S_p}}{L_s^{S_p} + L^{S_p}} \cdot es$$

```{r, fig.width=4}
population <- ypr_population_update(population, Ls = 50, Sp = 10, es = 0.8)
ypr_plot_schedule(population, "Length", "Spawning")
```

### Mortality

### Natural Mortality

The annual interval natural mortality rate is assumed to vary by length according to the equation

$$ N = 1 - exp(-M \cdot L^{M_\beta})$$
```{r, fig.width=4}
population <- ypr_population_update(population, M = 0.2, Mb = -0.5)
ypr_plot_schedule(population, "Length", "NaturalMortality")
```
and can include spawning mortality

```{r, fig.width=4}
population <- ypr_population_update(population, Sm = 0.5)
ypr_plot_schedule(population, "Length", "NaturalMortality")
```

### Fishing Mortality

The vulnerability to capture (V) is assumed to vary by length as follows

$$V = \frac{L^{V_p}}{L_v^{V_p} + L^{V_p}}$$

```{r, fig.width=4}
population <- ypr_population_update(population, Lv = 50, Vp = 100)
ypr_plot_schedule(population, "Length", "Vulnerability")
```

while the probabilty of release (R) depends on the release rate, the slot limits and the non-compliance with the limits

```{r, fig.width=4}
population <- ypr_population_update(population, rho = 0.5, Llo = 40, Lup = 70, Nc = 0.1)
ypr_plot_schedule(population, "Length", "Release")
```

